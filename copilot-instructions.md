copilot-instructions

Quick developer guide for working in this repository (gemini-cli)

1. Purpose

- This project is a TypeScript monorepo providing CLI tooling and an Edit/replace tool used by the core package.

2. Common tasks

- Install runtime deps (from repo root):
  npm install

- Build (project uses custom build scripts):
  npm run build

- Run unit tests (fast targeted runs):
  npx vitest run <path-to-test-file> -t "<test name substring>"

3. Edit tool notes

- File: packages/core/src/tools/edit.ts
- Supports string-based edits and precise range-based edits (line/column). Key params:
  - file_path (absolute)
  - old_string, new_string (string-based)
  - target_occurrence: number | 'first' | 'last' | 'all' (default: 'all' historically)
  - expected_replacements: validation for number of replacements
  - start_line/start_column/end_line/end_column/new_content (range-based)
  - modified_by_user, ai_proposed_string (metadata)
- The tool includes autofix heuristics (whitespace normalization, diff-match-patch, fuzzy sliding-window) to attempt to match LLM-proposed snippets to actual file content.
- The tool will validate ambiguity (multiple occurrences) and return clear ToolErrorType codes when mismatches occur.

4. Troubleshooting

- If TypeScript reports missing module/type for runtime fuzzy-match libraries, install them from the repo root:
  npm install string-similarity diff-match-patch

- If tests complain about types for these libs, add types or cast minimally in code; prefer installing packages first.

5. Developer workflow suggestions

- Make small, targeted changes and run just the affected tests with Vitest to iterate quickly.
- Use the existing tool tests in `packages/core/src/tools` as a reference for desired Edit tool behavior.

6. Contacts

- Add notes here for maintainers, or update this file with project-specific developer instructions.

Generated by an automated assistant to help contributors get started and to document recent Edit tool changes.
